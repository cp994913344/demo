<!DOCTYPE html>
<html lang="zh-CN">
    <head> 
        <meta charset="utf-8" /> 
        <title>登录</title>
        <meta name="renderer" content="webkit" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" /> 
        <meta name="keywords" content="随行游,随行游旅游" />
        <meta name="description" content="随行游旅游是一家提供专业导游、伴游、同游的服务平台，方便您找到志同道合的朋友一起旅行，一起快乐旅游，结伴旅游，同行之路，有你才有意义。" />
        <meta http-equiv="Cache-Control" content="no-transform" /> 
        <link rel="shortcut icon" href="images/favicon.ico" /> 
        <link rel="canonical" href="index.html" /> 
        <link rel="stylesheet" type="text/css" href="css/common.css" /> 
        <link rel="stylesheet" type="text/css" href="css/index.css" />
        <style>
            .lookDiv{
                background-color: rgba(250,250,250,1);
                margin: -5% 0px 0px 75%;
                height: 360px;
                width: 350px;
            }
            .text{
                padding: 14px;
                width: 250px;
                height: 20px;
                line-height: 20px;
                font-size: 14px;
                color: #757575;
                border: #ebebeb solid 1px;
                -moz-border-radius: 2px;
                -webkit-border-radius: 2px;
                border-radius: 2px;
            }
            .input-submit {
                width: 88%;
                height: 40px;
                line-height: 40px;
                border: medium none;
                background: #3d5480;
                color: #fff;
                cursor: pointer;
                -webkit-appearance: none;
                -moz-border-radius: 5px;
                -webkit-border-radius: 5px;
                border-radius: 5px;
            }
            .or{
                position: absolute;
                top: 76%;
                left: 85%;
                width: 24px;
                margin-left: -12px;
                background: #fff;
                text-align: center;
                font-size: 12px;
                color: #bdbdbd;
            }
            .error{
                height: 20px;
                color: #d34242;
                font-size: 12px;
                margin-left: 30%;
                padding-top: 5px;
            }
            .displayNone{
                display: none;
            }
        </style>
    </head>
    <body> 
        <div class="wrapper"> 
            <div class="header"> 
                <div class="mod-head"> 
                </div>
            </div>
            <div class="container"> 
                <div class="full-column"> 
                    <div class="mod-bg"> 
                        <img class="fixed" src="images/bg.jpg" /> 
                        <img class="static" src="images/bg.jpg" /> 
                    </div> 
                    <div class="mod-search"> 
                        <div class="mcore">
                            <p>来这里，<br />换一种旅游方式</p> 
                        </div>
                        <div class="lookDiv">
                            <div id="errordiv" class="displayNone" >
                                <p class="error" ><span ></span></p>
                            </div>
                            <div id="loginDiv" >
                                <div class="hd" style="padding-top: 10px;"><h2 style="font-size: 25px;    margin: 0px 0px 5% 40%;">登 录</h2></div>
                                <div class="bd"  >
                                    <div style="    margin: 0px 0px 19px 35px">
                                        <input class="text" type="text" name="userEmailCode" placeholder="请输入邮箱账号" >
                                    </div>
                                    <div style="    margin: 0px 0px 19px 35px">
                                        <input type="password" class="text" name="userPassword" placeholder="请输入密码" >
                                    </div>
                                    <div style="    margin: 0px 0px 19px 35px">
                                        <a  style="float: right; margin: 0% 10% 5% 0%;" href="" target="_blank">忘记密码</a>
                                    </div>
                                    <div style=" margin:0px 0px 5% 10%;">
                                        <input class="input-submit" type="button" onclick="login()" value="登 录"></p>
                                        <br>
                                        <div>
                                            <span style="margin: 0px 23px 17px 0px;display: block;border-top: 1px solid #ebebeb;"></span>
                                        </div>
                                        <a style="margin: 0px 0px 0px 34%;margin-bottom: 15px;text-align: center;" onclick="changeDiv('1')">立即注册</a>
                                    </div>
                                </div>
                            </div>
                            <div class="panel reg" id="registerDiv" style="display: none;">
                                <div class="hd">
                                    <div class="hd" style="padding-top: 10px;"><h2 style="font-size: 25px; margin: 0px 0px 5% 30%;">快 速 注 册</h2></div>
                                </div>
                                <div class="bd">
                                    <div style="margin: 0px 0px 19px 35px">
                                        <input class="text" type="text"  name="emailCode" onchange="changeCode()" placeholder="请输入邮箱" maxlength="20">
                                    </div>
                                    <div style="margin: 0px 0px 19px 35px">
                                        <input class="text" style="width: 86px;" type="text" name="captcha" placeholder="请输入验证码"  maxlength="5">
                                        <img src="/registration/kaptchaServlet.jpg" style=" width: 50%;" id="codeImage" onclick="changeCode()" />
                                    </div>
                                    <div style="margin: 0px 0px 19px 35px">
                                         <input class="text" style="width: 140px;" type="text" name="emailCaptcha" placeholder="请输入邮箱验证码"  maxlength="6">
                                        <a style="margin-left: 4%;"  onclick="sendEmailCode(this)">发送邮箱验证码</a>
                                        <a style="margin-left: 12%;display: none" ></a>
                                    </div>
                                    <div style="margin: 0px 0px 19px 35px">
                                        <input class="text" type="password" name="password" placeholder="请输入密码" maxlength="11">
                                    </div>
                                    <div style=" margin:0px 0px 5% 10%;">
                                        <input class="input-submit" type="button"  onclick="register()" value="立即注册"></p>
                                        <br>
                                        <div>
                                            <span style="margin: 0px 23px 17px 0px;display: block;border-top: 1px solid #ebebeb;"></span>
                                        </div>
                                        <a style="margin: 0px 0px 0px 40%;margin-bottom: 15px;text-align: center;" onclick="changeDiv('0')">登录</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="footer">
                    <div class="mod-foot">
                        <div class="info">
                            <div class="contact">
                                <p class="logo">
                                    <a href="/">
                                        <img src="../images/logo.png" alt="联途#192233" width="136" height="50"></a>
                                        <!--<img src="http://static.liantu.cn/image/public/logo.png" alt="联途" width="136" height="50"></a>-->
                                    <span>同行之路，有你才有意义</span>
                                </p>
                                <p class="tell">4006 666863</p>
                                <p>24小时服务热线</p>
                            </div>
                            <dl>
                                <dt>公司信息</dt>
                                <dd><a href="" target="_blank" rel="nofollow">关于我们</a></dd>
                                <dd><a href="" target="_blank" rel="nofollow">免责声明</a></dd>
                                <dd><a href="" target="_blank" rel="nofollow">联系我们</a></dd>
                                <dd><a href="" target="_blank" rel="nofollow">加入我们</a></dd>
                            </dl>
                            <dl>
                                <dt>帮助中心</dt>
                                <dd><a href="" target="_blank" rel="nofollow">用户协议</a></dd>
                                <dd><a href="" target="_blank" rel="nofollow">安全保障</a></dd>
                                <dd><a href="" target="_blank" rel="nofollow">预定流程</a></dd>
                            </dl>
                            <dl class="app">
                                <dt>发现</dt>
                                <dd>
                                    <a href="" target="_blank">Android客户端</a><br>
                                    <a href="" target="_blank">iOS客户端</a>
                                </dd>
                            </dl>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script src="/js/jquery-3.3.1.js"></script>
        <script>
            function changeDiv(changeNum){
                //1 注册 0登录
                if(changeNum == "1"){
                    $("#registerDiv").show();
                    $("#loginDiv").hide();
                    $(".lookDiv").height("460px");

                }else if(changeNum == "0"){
                    $("#registerDiv").hide();
                    $("#loginDiv").show();
                    $(".lookDiv").height("360px");
                }
            }

            function sendEmailCode(thes) {
                var myreg = /^([0-9A-Za-z\-_\.]+)@([0-9a-z]+\.[a-z]{2,3}(\.[a-z]{2})?)$/g;
                var temp = $("input[name='emailCode']").val();
                var captcha = $("input[name='captcha']").val();
                if(!myreg.test(temp)){
                    errorShow("请输入正确的邮箱号")
                    return;
                }
                if(!captcha||captcha.length<5){
                    errorShow("请输入正确的验证码")
                    return;
                }
                $(thes).hide();
                $(thes).next().show();
                $.ajax({
                    url:'/getEmailCode',
                    data:{
                        "saveCode":captcha.trim(),
                        "email" : temp
                    },
                    type :'post',
                    success:function(_res){
                        if(_res){
                            if(_res.code===500){
                                errorShow(_res.message);
                            }
                        }
                    }
                });
                sendEmailCodeFunc($(thes).next(),60);
            }

            function sendEmailCodeFunc($thes,leftTime) {
                if(leftTime>0){
                    $thes.text(leftTime+"s重新获取");
                    setTimeout(function(){
                        leftTime = parseInt(leftTime-1);
                        sendEmailCodeFunc($thes,leftTime);
                    },1000);
                }else{
                    $thes.hide();
                    $thes.prev().show();
                }
            }

            function changeCode(){
                $("#codeImage").attr("src","/registration/kaptchaServlet.jpg");
            }

            function errorHide(leftTime){
                if(leftTime>0){
                    setTimeout(function(){
                        leftTime = parseInt(leftTime-1);
                        errorHide(leftTime);
                    },1000);
                }else{
                    if(!$("#errordiv").hasClass("displayNone")){
                        $("#errordiv").addClass("displayNone");
                    }
                }
            }

            function errorShow(showText){
                $("#errordiv span").text(showText);
                if($("#errordiv").hasClass("displayNone")){
                    $("#errordiv").removeClass("displayNone");
                }
                errorHide(5);
            }

            function  register(){
                var email = $("input[name='emailCode']").val();
                var password = $("input[name='password']").val();
                var emailCode = $("input[name='emailCaptcha']").val();
                if(!email){
                    errorShow("请输入正确的邮箱");
                    return;
                }
                if(!emailCode||emailCode.size<6){
                    errorShow("请输入正确的邮箱验证码");
                    return;
                }
                if(!password){
                    errorShow("请输入密码");
                    return;
                }
                if(password.length<6){
                    errorShow("密码不能小于六位");
                    return;
                }
                $.ajax({
                    url:'/visitor/register',
                    data:{
                        "emailCode":emailCode.trim(),
                        "password":password.trim(),
                        "email":email.trim()
                    },
                    type :'post',
                    success:function(_res){
                        if(_res){
                            if(_res.code===500){
                                errorShow(_res.message);
                            }else if(_res.code===200){
                                $("input[name='userEmailCode']").val(email);
                                $("input[name='userPassword']").val(password);
                                changeDiv('0');
                            }
                        }
                    }
                });

            }

            function  login(){
                var email = $("input[name='userEmailCode']").val();
                var password = $("input[name='userPassword']").val();
                var myreg = /^([0-9A-Za-z\-_\.]+)@([0-9a-z]+\.[a-z]{2,3}(\.[a-z]{2})?)$/g;
                if(!myreg.test(email)){
                    errorShow("请输入正确的邮箱号")
                    return;
                }
                if(!password){
                    errorShow("请输入密码");
                    return;
                }
                $.ajax({
                    url:'/visitor/login',
                    data:{
                        "password":password.trim(),
                        "email":email.trim()
                    },
                    type :'post',
                    success:function(_res){
                        if(_res){
                            if(_res.code===500){
                                errorShow(_res.message);
                            }else if(_res.code===200){
                                history.back();
                            }
                        }
                    }
                });

            }

        </script>
    </body>
</html>